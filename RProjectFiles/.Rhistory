ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER), width=3))+geom_bar()+labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER), width=30))+geom_bar()+labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER), size=30))+geom_bar()+labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
width
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER), width=30))+geom_bar()+labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER), width=30))+geom_bar(stat="identity",position="fill") + theme_bw() + theme(axis.title.y=element_blank()) +theme(axis.text.y=element_text(size=10)) +theme(axis.title.x=element_blank()) +theme(legend.text=element_text(size=10)) +theme(legend.title=element_text(size=10)) +scale_y_continuous(labels = percent_format()) +geom_bar(colour="white",stat="identity",position="fill",show_guide=FALSE) + theme(panel.grid.minor=element_blank(), panel.grid.major=element_blank()) + theme(legend.position="bottom") +coord_equal(1/0.2) +labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER), width=30))+geom_bar(stat="identity",position="fill") + theme_bw() + theme(axis.title.y=element_blank()) +theme(axis.text.y=element_text(size=10)) +theme(axis.title.x=element_blank()) +theme(legend.text=element_text(size=10)) +theme(legend.title=element_text(size=10)) +geom_bar(colour="white",stat="identity",position="fill",show_guide=FALSE) + theme(panel.grid.minor=element_blank(), panel.grid.major=element_blank()) + theme(legend.position="bottom") +coord_equal(1/0.2) +labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
geom_bar()
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER), width=30))+geom_bar()+labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER), width=30))+geom_bar(stat="identity", width=.8)+labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER), width=30))+geom_bar(stat="identity", width=.8)+labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER)))+geom_bar(stat="identity", width=1)+labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
geom_bar()
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Amount of peers who smoke cigarettes colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))
summary(YESTSCIGXXXX)
summary(thesubset)
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="# of cigarette smoking peers colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
head(thesubset)
nums<-c(nrow(subset(thesubset, CIGEVER==1 & YESTSCIGXXXX==1))/nrow(subset(thesubset, YESTSCIGXXXX==1)), nrow(subset(thesubset, CIGEVER==1 & YESTSCIGXXXX==2))/nrow(subset(thesubset, YESTSCIGXXXX==2)), nrow(subset(thesubset, CIGEVER==1 & YESTSCIGXXXX==3))/nrow(subset(thesubset, YESTSCIGXXXX==3)), nrow(subset(thesubset, CIGEVER==1 & YESTSCIGXXXX==4))/nrow(subset(thesubset, YESTSCIGXXXX==4)))
plot(nums)
qplot(seq_along(nums), nums)
qplot(seq_along(nums), nums, aes(size=5))
```
qplot(seq_along(nums), nums, aes(size=5))
qplot(seq_along(nums), nums, aes(size=50))
qplot(seq_along(nums), size=10)
qplot(seq_along(nums), size=I(10))
qplot(seq_along(nums), size=I(3))
qplot(seq_along(nums), nums, size=I(5))
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="# of cigarette smoking peers colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
qplot(seq_along(nums), nums, size=I(5))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of amount of smoking peers that have had a cigarette", xlab="Amount of peers who smoke cigarettes", ylab="Proportion of respondents who have smoked a cigarette")
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of amount of smoking peers that have had a cigarette", xlab="Amount of peers who smoke cigarettes", ylab="Proportion of respondents who have smoked a cigarette") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("None", "A few", "Most", "All"))
yeyfgtsw <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, yeyfgtsw from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
cigever <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(cigever, yeyfgtsw)
thesubset<-subset(merged, YEYFGTSW<6 & CIGEVER<3)
thesubset<-subset(merged, yeyfgtsw<6 & cigever<3)
head(merged)
head(yeyfgtsw)
yeyfgtsw <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, yeyfgtswxxxx as yeyfgtsw from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
cigever <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(CIGEVER, YEYFGTSW)
merged<-merge(cigever, yeyfgtsw)
thesubset<-subset(merged, yeyfgtsw<6 & cigever<3)
thesubset<-subset(merged, YEYFGTSW<6 & CIGEVER<3)
merged<-merge(cigever, yeyfgtsw)
yeyfgtsw <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select ridxxxx as rid, yeyfgtswxxxx as yeyfgtsw from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
cigever <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(cigever, yeyfgtsw)
thesubset<-subset(merged, YEYFGTSW<6 & CIGEVER<3)
ggplot(thesubset, aes(x=YEYFGTSW, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=YEYFGTSW, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("0" = "0","1" = "1 or 2", "2" = "3 to 5","3" = "6 to 9", "4" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
1
ggplot(thesubset, aes(x=YEYFGTSW, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=YEYFGTSW, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", 5 = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
"
ggplot(thesubset, aes(x=YEYFGTSW, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=YEYFGTSW, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, CIGEVER==1 & YEYFGTSW==1))/nrow(subset(thesubset, YEYFGTSW==1)), nrow(subset(thesubset, CIGEVER==1 & YEYFGTSW==2))/nrow(subset(thesubset, YEYFGTSW==2)), nrow(subset(thesubset, CIGEVER==1 & YEYFGTSW==3))/nrow(subset(thesubset, YEYFGTSW==3)), nrow(subset(thesubset, CIGEVER==1 & YEYFGTSW==4))/nrow(subset(thesubset, YEYFGTSW==4)), nrow(subset(thesubset, CIGEVER==1 & YEYFGTSW==4))/nrow(subset(thesubset, YEYFGTSW==4)))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of serious fights at school/work that have had a cigarette", xlab="Number of serious fights at school/work", ylab="Proportion of respondents who have smoked a cigarette") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("0", "1 or 2", "3 to 5", "6 to 9", "10 or more"))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of serious fights at school/work that have had a cigarette", xlab="Number of serious fights at school/work", ylab="Proportion of respondents who have smoked a cigarette") + scale_x_continuous(breaks=c(1, 2, 3, 4, 5), labels=c("0", "1 or 2", "3 to 5", "6 to 9", "10 or more"))
halcig <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever, lsd, pcp, peyote, mesc, psilcy, ecstasy from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(halcig, CIGEVER<3 & LSD<3 & PCP<3 & PEYOTE<3 & MESC<3 & PSILCY<3 & ECSTASY<3)
head(thesubset)
summary(thesubset)
ggplot(thesubset, aes(x=PSILCY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=MESC, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=PEYOTE, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=PCP, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=LSD, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=PCP, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=PEYOTE, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=MESC, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=PSILCY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
alctry <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever, alctry from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
library("DBI", lib.loc="~/R/win-library/3.0")
library("devtools", lib.loc="~/R/win-library/3.0")
library("ggplot2", lib.loc="~/R/win-library/3.0")
library("gtools", lib.loc="~/R/win-library/3.0")
library("knitr", lib.loc="~/R/win-library/3.0")
library("markdown", lib.loc="~/R/win-library/3.0")
library("plyr", lib.loc="~/R/win-library/3.0")
library("RCurl", lib.loc="~/R/win-library/3.0")
library("rJava", lib.loc="~/R/win-library/3.0")
library("RJDBC", lib.loc="~/R/win-library/3.0")
library("rmarkdown", lib.loc="~/R/win-library/3.0")
library("sqldf", lib.loc="~/R/win-library/3.0")
library("stats", lib.loc="C:/Program Files/R/R-3.0.3/library")
alctry <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever, alctry from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(merged, CIGEVER<3 & ALCTRY<76)
thesubset<-subset(merged, CIGEVER<3 & alctry<76)
head(thesubset)
alctry <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever, alctry from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
alctry <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever, alctry from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
alccig <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever, alctry from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(alccig, CIGEVER<3 & ALCTRY<76)
head(thesubset)
thesubset$alctry
thesubset$ALCTRY
thesubset$ALCTRY<-.bincode(thesubset$ALCTRY, FALSE)
head(thesubset)
thesubset<-subset(alccig, CIGEVER<3 & ALCTRY<76)
head(thesubset)
.bincode(thesubset$ALCTRY, FALSE)
head(thesubset)
str(thesubset$ALCTRY)
thesubset$ALCTRY<-cut(thesubset$ALCTRY, 13, include.lowest=TRUE, right=FALSE)
head(thesubset)
thesubset$ALCTRY<-cut(thesubset$ALCTRY, c(12, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71), include.lowest=TRUE, right=FALSE)
thesubset<-subset(alccig, CIGEVER<3 & ALCTRY<76)
thesubset$ALCTRY<-cut(thesubset$ALCTRY, c(12, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71), include.lowest=TRUE, right=FALSE)
head(thesubset)
thesubset$ALCTRY<-cut(thesubset$ALCTRY, c(12, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71), labels=FALSE, include.lowest=TRUE, right=FALSE)
thesubset<-subset(alccig, CIGEVER<3 & ALCTRY<76)
thesubset$ALCTRY<-cut(thesubset$ALCTRY, c(12, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71), labels=FALSE, include.lowest=TRUE, right=FALSE)
head(thesubset)
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever smoked cigarette", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "12","2" = "16", "3" = "21","4" = "26", "5" = "31", "5" = "36", "5" = "41", "5" = "46", "5" = "51", "5" = "56", "5" = "61", "5" = "66", "5" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "12","2" = "16", "3" = "21","4" = "26",  "5" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
"5" = "31", "5" = "36", "5" = "41", "5" = "46", "5" = "51", "5" = "56", "5" = "61", "5" = "66",
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "12","2" = "16", "3" = "21","4" = "26", "5" = "31", "5" = "36", "5" = "41", "5" = "46", "5" = "51", "5" = "56", "5" = "61", "5" = "66", "5" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "12","2" = "16", "3" = "21","4" = "26", "5" = "31", "6" = "36", "7" = "41", "8" = "46", "9" = "51", "10" = "56", "11" = "61", "12" = "66", "13" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, CIGEVER==1 & ALCTRY==1))/nrow(subset(thesubset, ALCTRY==1)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==2))/nrow(subset(thesubset, ALCTRY==2)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==3))/nrow(subset(thesubset, ALCTRY==3)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==4))/nrow(subset(thesubset, ALCTRY==4)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==5))/nrow(subset(thesubset, ALCTRY==5)))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of age of first alcohol use that have had a cigarette", xlab="Age respondent first tried alcohol", ylab="Proportion of respondents who have smoked a cigarette") + scale_x_continuous(breaks=c(1, 2, 3, 4, 5), labels=c("12", "16", "21", "26", "31"))
alccigmj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigtry, alctry, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(alccigmj, CIGTRY<63 & ALCTRY<76 & mjever<3)
thesubset<-subset(alccigmj, CIGTRY<63 & ALCTRY<76 & MJEVER<3)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "12","2" = "16", "3" = "21","4" = "26", "5" = "31", "6" = "36", "7" = "41", "8" = "46", "9" = "51", "10" = "56", "11" = "61", "12" = "66", "13" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
thesubset<-subset(alccigmj, CIGTRY<63 & ALCTRY<63 & MJEVER<3)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "12","2" = "16", "3" = "21","4" = "26", "5" = "31", "6" = "36", "7" = "41", "8" = "46", "9" = "51", "10" = "56", "11" = "61", "12" = "66", "13" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, fill=as.factor(MJEVER)))
head(thesubset)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, fill=as.factor(MJEVER)))+geom_point()
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point()
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point()
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point()+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))++ stat_binhex()+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+ stat_binhex()+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
install.packages("hexbin")
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+ stat_binhex()+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+ stat_binhex()
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point(position=position_jitter(width=1,height=.5))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point(shape=1, position=position_jitter(width=1,height=.5))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/4)+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/4, position=position_jitter(width=1,height=.5))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+ geom_bin2d()
+geom_point(shape=19, alpha=1/4, position=position_jitter(width=1,height=.5))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/4, position=position_jitter(width=1,height=.5))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
alccig <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever, alctry from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(alccig, CIGEVER<3 & ALCTRY<76)
thesubset$ALCTRY<-cut(thesubset$ALCTRY, c(1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71), labels=FALSE, include.lowest=TRUE, right=FALSE)
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "1","2" = "6", "3" = "11","4" = "16", "5" = "21", "6" = "26", "7" = "31", "8" = "36", "9" = "41", "10" = "46", "11" = "51", "12" = "56", "13" = "61", "14" = "66", "15" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
alccig <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever, alctry from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(alccig, CIGEVER<3 & ALCTRY<76)
thesubset$ALCTRY<-cut(thesubset$ALCTRY, c(1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71), labels=FALSE, include.lowest=TRUE, right=FALSE)
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "1","2" = "6", "3" = "11","4" = "16", "5" = "21", "6" = "26", "7" = "31", "8" = "36", "9" = "41", "10" = "46", "11" = "51", "12" = "56", "13" = "61", "14" = "66", "15" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, CIGEVER==1 & ALCTRY==1))/nrow(subset(thesubset, ALCTRY==1)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==2))/nrow(subset(thesubset, ALCTRY==2)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==3))/nrow(subset(thesubset, ALCTRY==3)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==4))/nrow(subset(thesubset, ALCTRY==4)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==5))/nrow(subset(thesubset, ALCTRY==5)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==6))/nrow(subset(thesubset, ALCTRY==6)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==7))/nrow(subset(thesubset, ALCTRY==7)))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of age of first alcohol use that have had a cigarette", xlab="Age respondent first tried alcohol", ylab="Proportion of respondents who have smoked a cigarette") + scale_x_continuous(breaks=c(1, 2, 3, 4, 5), labels=c("12", "16", "21", "26", "31"))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of age of first alcohol use that have had a cigarette", xlab="Age respondent first tried alcohol", ylab="Proportion of respondents who have smoked a cigarette") + scale_x_continuous(breaks=c(1, 2, 3, 4, 5, 6, 7), labels=c("1", "6", "11", "16", "21", "26", "31"))
alccigmj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigtry, alctry, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(alccigmj, CIGTRY<63 & ALCTRY<63 & MJEVER<3)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/4, position=position_jitter(width=1,height=.5))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point()+ geom_density2d()
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point()+ geom_density2d()
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point()+ geom_density2d(size=3)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point()+ geom_density2d(size=2)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/4, position=position_jitter(width=1,height=.5))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/4, position=position_jitter(width=1,height=.5))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
alccig <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever, alctry from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(alccig, CIGEVER<3 & ALCTRY<76)
thesubset$ALCTRY<-cut(thesubset$ALCTRY, c(1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71), labels=FALSE, include.lowest=TRUE, right=FALSE)
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "1","2" = "6", "3" = "11","4" = "16", "5" = "21", "6" = "26", "7" = "31", "8" = "36", "9" = "41", "10" = "46", "11" = "51", "12" = "56", "13" = "61", "14" = "66", "15" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "1","2" = "6", "3" = "11","4" = "16", "5" = "21", "6" = "26", "7" = "31", "8" = "36", "9" = "41", "10" = "46", "11" = "51", "12" = "56", "13" = "61", "14" = "66", "15" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))+geom_vline(xintercept=21)
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "1","2" = "6", "3" = "11","4" = "16", "5" = "21", "6" = "26", "7" = "31", "8" = "36", "9" = "41", "10" = "46", "11" = "51", "12" = "56", "13" = "61", "14" = "66", "15" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))+geom_vline(xintercept=5)
ggplot(thesubset, aes(x=ALCTRY, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="Age of first use of alcohol colored by ever had cigarette", y="Count")+scale_x_discrete("Age respondent first tried alcohol", labels = c("1" = "1","2" = "6", "3" = "11","4" = "16", "5" = "21", "6" = "26", "7" = "31", "8" = "36", "9" = "41", "10" = "46", "11" = "51", "12" = "56", "13" = "61", "14" = "66", "15" = "71"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))+geom_vline(xintercept=4.5)
nums<-c(nrow(subset(thesubset, CIGEVER==1 & ALCTRY==1))/nrow(subset(thesubset, ALCTRY==1)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==2))/nrow(subset(thesubset, ALCTRY==2)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==3))/nrow(subset(thesubset, ALCTRY==3)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==4))/nrow(subset(thesubset, ALCTRY==4)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==5))/nrow(subset(thesubset, ALCTRY==5)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==6))/nrow(subset(thesubset, ALCTRY==6)), nrow(subset(thesubset, CIGEVER==1 & ALCTRY==7))/nrow(subset(thesubset, ALCTRY==7)))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of age of first alcohol use that have had a cigarette", xlab="Age respondent first tried alcohol", ylab="Proportion of respondents who have smoked a cigarette") + scale_x_continuous(breaks=c(1, 2, 3, 4, 5, 6, 7), labels=c("1", "6", "11", "16", "21", "26", "31"))+geom_vline(xintercept=4.5)
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of age of first alcohol use that have had a cigarette", xlab="Age respondent first tried alcohol", ylab="Proportion of respondents who have smoked a cigarette") + scale_x_continuous(breaks=c(1, 2, 3, 4, 5, 6, 7), labels=c("1", "6", "11", "16", "21", "26", "31"))+geom_vline(xintercept=5)
alccigmj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigtry, alctry, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(alccigmj, CIGTRY<63 & ALCTRY<63 & MJEVER<3)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/4, position=position_jitter(width=1,height=.5))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=1, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/4, position=position_jitter(width=1,height=.5))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.5, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/4, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/4, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=1/6, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.25, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.1, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, fill=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
colour
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, colour=as.factor(MJEVER)))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+geom_point(shape=19, alpha=.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
alccigmj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigtry, alctry, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(alccigmj, CIGTRY<63 & ALCTRY<63 & MJEVER<3)
replace(thesubset$MJEVER, thesubset$MJEVER==1, "Have used marijuana")
replace(thesubset$MJEVER, thesubset$MJEVER==2, "Have not used marijuana")
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
replace(thesubset$MJEVER, thesubset$MJEVER==1, "Have used marijuana")
head(thesubset)
thesubset$MJEVER<-replace(thesubset$MJEVER, thesubset$MJEVER==1, "Have used marijuana")
thesubset$MJEVER<-replace(thesubset$MJEVER, thesubset$MJEVER==2, "Have not used marijuana")
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use")+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("1", "6", "11", "16", "21", "26", "31", "36", "41", "46", "51", "56", "61", "66", "71"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=.7, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=2, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=3, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, size=5, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, size=5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, size=4, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, size=3, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, size=3.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, size=4, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, size=3.5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALCTRY, y=CIGTRY, colour=as.factor(MJEVER)))+geom_point(shape=19, alpha=.5, size=3, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
edu <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, educcat2 from demographics"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(mj, edu)
thesubset<-subset(merged, EDUCCAT2<5 & MJEVER<3)
ggplot(thesubset, aes(x=EDUCCAT2, fill=as.factor(MJEVER)))+geom_bar(width=.5)
nums<-c(nrow(subset(thesubset, MJEVER==1 & EDUCCAT2==1))/nrow(subset(thesubset, EDUCCAT2==1)), nrow(subset(thesubset, MJEVER==1 & EDUCCAT2==2))/nrow(subset(thesubset, EDUCCAT2==2)), nrow(subset(thesubset, MJEVER==1 & EDUCCAT2==3))/nrow(subset(thesubset, EDUCCAT2==3)), nrow(subset(thesubset, MJEVER==1 & EDUCCAT2==4))/nrow(subset(thesubset, EDUCCAT2==4)))
head(thesubset)
plot(nums)
lif <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select ridxxxx as rid, lifdeprsxxxx as lifdeprs from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(lif, mj)
thesubset<-subset(merged, LIFDEPRS<7 & MJEVER<3)
ggplot(thesubset, aes(x=LIFDEPRS, fill=as.factor(MJEVER)))+geom_bar()+labs(title="# of cigarette smoking peers colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=LIFDEPRS, fill=as.factor(MJEVER)))+geom_bar()
head(thesubset)
dev.off()
ggplot(thesubset, aes(x=LIFDEPRS, fill=as.factor(MJEVER)))+geom_bar()
nums<-c(nrow(subset(thesubset, MJEVER==1 & LIFDEPRS==1))/nrow(subset(thesubset, LIFDEPRS==1)), nrow(subset(thesubset, MJEVER==1 & LIFDEPRS==6))/nrow(subset(thesubset, LIFDEPRS==6)))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of serious fights at school/work that have had a cigarette", xlab="Number of serious fights at school/work", ylab="Proportion of respondents who have smoked a cigarette") + scale_x_continuous(breaks=c(1, 2, 3, 4, 5), labels=c("0", "1 or 2", "3 to 5", "6 to 9", "10 or more"))
nrow(subset(thesubset, LIFDEPRS==1))
nrow(subset(thesubset, LIFDEPRS==6))
nrow(subset(thesubset, MJEVER==1 & LIFDEPRS==1))
nrow(subset(thesubset, MJEVER==1 & LIFDEPRS==6))
ggplot(thesubset, aes(x=LIFDEPRS, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Ever had depression colored by ever used marijuana", y="Count")+scale_x_discrete("Ever had depression", labels=c("1"="Yes", "6"="No"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
lif <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select ridxxxx as rid, lifdeprsxxxx as lifdeprs from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(lif, mj)
thesubset<-subset(merged, LIFDEPRS<7 & MJEVER<3)
ggplot(thesubset, aes(x=LIFDEPRS, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Ever had depression colored by ever used marijuana", y="Count")+scale_x_discrete("Ever had depression", labels=c("1"="Yes", "6"="No"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, MJEVER==1 & LIFDEPRS==1))/nrow(subset(thesubset, LIFDEPRS==1)), nrow(subset(thesubset, MJEVER==1 & LIFDEPRS==6))/nrow(subset(thesubset, LIFDEPRS==6)))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of depression that have used marijuana", xlab="Ever had depression", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 6), labels=c("Yes, "No"))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of depression that have used marijuana", xlab="Ever had depression", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 6), labels=c("Yes, "No"))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of depression that have used marijuana", xlab="Ever had depression", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 6), labels=c("Yes"", "No"))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of depression that have used marijuana", xlab="Ever had depression", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 6), labels=c("Yes", "No"))
```
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of depression that have used marijuana", xlab="Ever had depression", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 6), labels=c("Yes", "No"))
barplot(nums)
barplot(nums, ylim=c(0,1))
barplot(nums, ylim=c(0,1), ylab = "Proportion of respondents who have used marijuana", xlab="Ever had depression", names.arg=c("Yes", "No"))
barplot(nums, ylim=c(0,1), ylab = "Proportion of respondents who have used marijuana", xlab="Ever had depression", names.arg=c("Yes", "No"), main="Proportion of each level of depression that have used marijuana")
drv <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select ridxxxx as rid, drvaldr2xxxx as drvaldr2 from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(drv, mj)
thesubset<-subset(merged, DRVALDR2<3 & MJEVER<3)
ggplot(thesubset, aes(x=DRVALDR2, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Driven on alcohol and illicit drugs in past year colored by ever used marijuana", y="Count")+scale_x_discrete("Ever driven on alcohol and illicit drugs", labels=c("1"="Yes", "2"="No"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
thesubset<-subset(merged, DRVALDR2<=2 & MJEVER<3)
ggplot(thesubset, aes(x=DRVALDR2, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Driven on alcohol and illicit drugs in past year colored by ever used marijuana", y="Count")+scale_x_discrete("Ever driven on alcohol and illicit drugs", labels=c("1"="Yes", "2"="No"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, MJEVER==1 & DRVALDR2==1))/nrow(subset(thesubset, DRVALDR2==1)), nrow(subset(thesubset, MJEVER==1 & DRVALDR2==2))/nrow(subset(thesubset, DRVALDR2==2)))
barplot(nums, ylim=c(0,1), ylab = "Proportion of respondents who have used marijuana", xlab="Ever driven on alcohol and illicit drugs", names.arg=c("Yes", "No"), main="Proportion of each level of driven on alcohol and illicit drugs that have used marijuana")
nrow(subset(thesubset, MJEVER==1 & DRVALDR2==1))/nrow(subset(thesubset, DRVALDR2==1))
nrow(subset(thesubset, MJEVER==1 & DRVALDR2==2))/nrow(subset(thesubset, DRVALDR2==2))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
yest <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select ridxxxx as rid, yestsmjxxxx as yestsmj from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(mj, yest)
thesubset<-subset(merged, YESTSMJ<5 & MJEVER<3)
ggplot(thesubset, aes(x=YESTSMJ, fill=as.factor(MJEVER)))+geom_bar()+labs(title="# of marijuana smoking peers colored by ever smoked marijuana", y="Count")+scale_x_discrete("Amount of peers who smoke marijuana", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, MJEVER==1 & YESTSMJ==1))/nrow(subset(thesubset, YESTSMJ==1)), nrow(subset(thesubset, MJEVER==1 & YESTSMJ==2))/nrow(subset(thesubset, YESTSMJ==2)), nrow(subset(thesubset, MJEVER==1 & YESTSMJ==3))/nrow(subset(thesubset, YESTSMJ==3)), nrow(subset(thesubset, MJEVER==1 & YESTSMJ==4))/nrow(subset(thesubset, YESTSMJ==4)))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of amount of marijuana smoking peers that have used marijuana", xlab="Amount of respondent's peers who use marijuana", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("None", "A few", "Most", "All"))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of amount of marijuana smoking peers that have used marijuana", xlab="Amount of respondent's peers who use marijuana", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("None", "A few", "Most", "All"))+ geom_smooth(se=FALSE, method="lm")
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of amount of marijuana smoking peers that have used marijuana", xlab="Amount of respondent's peers who use marijuana", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("None", "A few", "Most", "All"))+ geom_text(aes(x = 25, y = 300, label = lm_eqn(df)), parse = TRUE)
lm_eqn = function(df){
m = lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of amount of marijuana smoking peers that have used marijuana", xlab="Amount of respondent's peers who use marijuana", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("None", "A few", "Most", "All"))+ geom_text(aes(x = 25, y = 300, label = lm_eqn(df)), parse = TRUE)
+ geom_smooth(se=FALSE, method="lm")
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of amount of marijuana smoking peers that have used marijuana", xlab="Amount of respondent's peers who use marijuana", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("None", "A few", "Most", "All"))+ geom_smooth(se=FALSE, method="lm")
cigever <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
yestscigxxxx <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select ridxxxx as rid, yestscigxxxx from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(cigever, yestscigxxxx)
thesubset<-subset(merged, YESTSCIGXXXX<5 & CIGEVER<3)
ggplot(thesubset, aes(x=YESTSCIGXXXX, fill=as.factor(CIGEVER)))+geom_bar()+labs(title="# of cigarette smoking peers colored by ever smoked cigarette", y="Count")+scale_x_discrete("Amount of peers who smoke cigarettes", labels = c("1" = "None","2" = "A few", "3" = "Most","4" = "All"))+scale_fill_discrete(name="Ever had cigarette", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, CIGEVER==1 & YESTSCIGXXXX==1))/nrow(subset(thesubset, YESTSCIGXXXX==1)), nrow(subset(thesubset, CIGEVER==1 & YESTSCIGXXXX==2))/nrow(subset(thesubset, YESTSCIGXXXX==2)), nrow(subset(thesubset, CIGEVER==1 & YESTSCIGXXXX==3))/nrow(subset(thesubset, YESTSCIGXXXX==3)), nrow(subset(thesubset, CIGEVER==1 & YESTSCIGXXXX==4))/nrow(subset(thesubset, YESTSCIGXXXX==4)))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of amount of smoking peers that have had a cigarette", xlab="Amount of respondent's peers who smoke cigarettes", ylab="Proportion of respondents who have smoked a cigarette") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("None", "A few", "Most", "All"))+ geom_smooth(se=FALSE, method="lm")
yey <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select ridxxxx as rid, yeyfgtswxxxx as yeyfgtsw from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(yey, mj)
thesubset<-subset(merged, YEYFGTSW<6 & MJEVER<3)
ggplot(thesubset, aes(x=YEYFGTSW, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Frequency of serious fights at school/work colored by ever used marijuana", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, MJEVER==1 & YEYFGTSW==1))/nrow(subset(thesubset, YEYFGTSW==1)), nrow(subset(thesubset, MJEVER==1 & YEYFGTSW==2))/nrow(subset(thesubset, YEYFGTSW==2)), nrow(subset(thesubset, MJEVER==1 & YEYFGTSW==3))/nrow(subset(thesubset, YEYFGTSW==3)), nrow(subset(thesubset, MJEVER==1 & YEYFGTSW==4))/nrow(subset(thesubset, YEYFGTSW==4)), nrow(subset(thesubset, MJEVER==1 & YEYFGTSW==5))/nrow(subset(thesubset, YEYFGTSW==5)))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of serious fights at school/work that have used marijuana", xlab="Number of serious fights at school/work", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3, 4, 5), labels=c("0", "1 or 2", "3 to 5", "6 to 9", "10 or more"))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever, alcever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
cat <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, catag6 from demographics"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(mj, cat)
thesubset<-subset(merged, MJEVER<3 & ALCEVER<3)
ggplot(thesubset, aes(x=CATAG6, fill=as.factor(MJEVER)))+geom_bar(width=.5)
ggplot(thesubset, aes(x=CATAG6, fill=as.factor(MJEVER)))+geom_bar(width=.5)+labs(title="Frequency of serious fights at school/work colored by ever used marijuana", y="Count")+scale_x_discrete("Number of serious fights at school/work", labels = c("1" = "0","2" = "1 or 2", "3" = "3 to 5","4" = "6 to 9", "5" = "10 or more"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=CATAG6, fill=as.factor(MJEVER)))+geom_bar(width=.5)+labs(title="Age colored by ever used marijuana", y="Count")+scale_x_discrete("Age", labels = c("1" = "12","2" = "18", "3" = "26","4" = "35", "5" = "50", "6"="50+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=CATAG6, fill=as.factor(ALCEVER)))+geom_bar(width=.5)+labs(title="Age colored by ever used alcohol", y="Count")+scale_x_discrete("Age", labels = c("1" = "12","2" = "18", "3" = "26","4" = "35", "5" = "50", "6"="50+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=CATAG6, fill=as.factor(ALCEVER)))+geom_bar(width=.5)+labs(title="Age colored by ever used alcohol", y="Count")+scale_x_discrete("Age", labels = c("1" = "12","2" = "18", "3" = "26","4" = "35", "5" = "50", "6"="50+"))+scale_fill_discrete(name="Ever used alcohol", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, MJEVER==1 & CATAG6==1))/nrow(subset(thesubset, CATAG6==1)), nrow(subset(thesubset, ALCEVER==1 & CATAG6==1))/nrow(subset(thesubset, CATAG6==1)), nrow(subset(thesubset, MJEVER==1 & CATAG6==2))/nrow(subset(thesubset, CATAG6==2)),nrow(subset(thesubset, ALCEVER==1 & CATAG6==2))/nrow(subset(thesubset, CATAG6==2)),nrow(subset(thesubset, MJEVER==1 & CATAG6==3))/nrow(subset(thesubset, CATAG6==3)),nrow(subset(thesubset, ALCEVER==1 & CATAG6==3))/nrow(subset(thesubset, CATAG6==3)),nrow(subset(thesubset, MJEVER==1 & CATAG6==4))/nrow(subset(thesubset, CATAG6==4)),nrow(subset(thesubset, ALCEVER==1 & CATAG6==4))/nrow(subset(thesubset, CATAG6==4)),nrow(subset(thesubset, MJEVER==1 & CATAG6==5))/nrow(subset(thesubset, CATAG6==5)),nrow(subset(thesubset, ALCEVER==1 & CATAG6==5))/nrow(subset(thesubset, CATAG6==5)),nrow(subset(thesubset, MJEVER==1 & CATAG6==6))/nrow(subset(thesubset, CATAG6==6)),nrow(subset(thesubset, ALCEVER==1 & CATAG6==6))/nrow(subset(thesubset, CATAG6==6)))
ages<-c(1,1,2, 2,3, 3,4, 4,5, 5,6, 6)
substance<-c("M", "A", "M", "A", "M", "A", "M", "A", "M", "A", "M", "A")
thedf<-data.frame(ages,nums, substance)
thedf<-data.frame(ages,nums, substance)
ggplot(data=thedf, aes(x=ages, y=nums, group=substance, colour=substance)) + geom_line(size=1.5) + geom_point(size=3, fill="white") + scale_shape_manual(values=c(22,21))
ggplot(data=thedf, aes(x=ages, y=nums, group=substance, colour=substance)) + geom_line(size=1.5) + geom_point(size=3, fill="white") + scale_shape_manual(values=c(22,21))+labs(title="Proportion of marijuana and alcohol users by age", y="Propotion of users")+scale_x_discrete("Age", labels = c("1" = "12","2" = "18", "3" = "26","4" = "35", "5" = "50", "6"="50+"))+scale_fill_discrete(name="Substance", breaks=c("1", "2"), labels=c("Alcohol", "Marijuana"))
snr <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select ridxxxx as rid, snrlgsvcxxxx as snrlgsvc from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(mj, snr)
thesubset<-subset(merged, SNRLGSVC<7 & MJEVER<3)
ggplot(thesubset, aes(x=SNRLGSVC, fill=as.factor(MJEVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, MJEVER==1 & YESTSMJ==1))/nrow(subset(thesubset, YESTSMJ==1)), nrow(subset(thesubset, MJEVER==1 & YESTSMJ==2))/nrow(subset(thesubset, YESTSMJ==2)), nrow(subset(thesubset, MJEVER==1 & YESTSMJ==3))/nrow(subset(thesubset, YESTSMJ==3)), nrow(subset(thesubset, MJEVER==1 & YESTSMJ==4))/nrow(subset(thesubset, YESTSMJ==4)), nrow(subset(thesubset, MJEVER==1 & YESTSMJ==5))/nrow(subset(thesubset, YESTSMJ==5)), nrow(subset(thesubset, MJEVER==1 & YESTSMJ==6))/nrow(subset(thesubset, YESTSMJ==6)))
nums<-c(nrow(subset(thesubset, MJEVER==1 & SNRLGSVC==1))/nrow(subset(thesubset, SNRLGSVC==1)), nrow(subset(thesubset, MJEVER==1 & SNRLGSVC==2))/nrow(subset(thesubset, SNRLGSVC==2)), nrow(subset(thesubset, MJEVER==1 & SNRLGSVC==3))/nrow(subset(thesubset, SNRLGSVC==3)), nrow(subset(thesubset, MJEVER==1 & SNRLGSVC==4))/nrow(subset(thesubset, SNRLGSVC==4)), nrow(subset(thesubset, MJEVER==1 & SNRLGSVC==5))/nrow(subset(thesubset, SNRLGSVC==5)), nrow(subset(thesubset, MJEVER==1 & SNRLGSVC==6))/nrow(subset(thesubset, SNRLGSVC==6)))
qplot(seq_along(nums), nums, size=I(5), main="Proportion of each level of religious attendance that have used marijuana", xlab="# of religious services attended in past year", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3, 4, 5, 6), labels=c("0", "1", "3", "6", "25", "52+"))+ geom_smooth(se=FALSE, method="lm")
qplot(seq_along(nums), nums, size=I(5), , ylim=c(0,1),main="Proportion of each level of religious attendance that have used marijuana", xlab="# of religious services attended in past year", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3, 4, 5, 6), labels=c("0", "1", "3", "6", "25", "52+"))+ geom_smooth(se=FALSE, method="lm")
nrow(subset(thesubset, MJEVER==1 & SNRLGSVC==1))/nrow(subset(thesubset, SNRLGSVC==1))
nrow(subset(thesubset, MJEVER==1 & SNRLGSVC==6))/nrow(subset(thesubset, SNRLGSVC==6))
0.5844156-0.2854241
irhedf <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select ridxxxx as rid, irhh65_2xxxx as irhh65_2, edfam18xxxx as edfam18 from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(irhedf, mj)
thesubset<-subset(merged, EDFAM18<2 & MJEVER<3)
ggplot(thesubset, aes(x=IRHH65_2, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Number of people in household over 65 colored by marijuana use", y="Count")+scale_x_discrete("# of people in household over 65", labels = c("1" = "0","2" = "1", "3" = "2"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, MJEVER==1 & IRHH65_2==1))/nrow(subset(thesubset, IRHH65_2==1)), nrow(subset(thesubset, MJEVER==1 & IRHH65_2==2))/nrow(subset(thesubset, IRHH65_2==2)), nrow(subset(thesubset, MJEVER==1 & IRHH65_2==3))/nrow(subset(thesubset, IRHH65_2==3)))
qplot(seq_along(nums), nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))+ geom_smooth(se=FALSE, method="lm")
nrow(subset(thesubset, MJEVER==1 & IRHH65_2==1))/nrow(subset(thesubset, IRHH65_2==1))
nrow(subset(thesubset, MJEVER==1 & IRHH65_2==3))/nrow(subset(thesubset, IRHH65_2==3))
preg <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select ridxxxx as rid, pregnantxxxx as pregnant from non_core"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(preg, mj)
thesubset<-subset(merged, PREGNANT<3 & MJEVER<3)
ggplot(thesubset, aes(x=PREGNANT, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Pregnant or not colored by marijuana use", y="Count")+scale_x_discrete("Pregnancy status", labels = c("1" = "Pregnant","2" = "Not pregnant"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, MJEVER==1 & PREGNANT==1))/nrow(subset(thesubset, PREGNANT==1)), nrow(subset(thesubset, MJEVER==1 & PREGNANT==2))/nrow(subset(thesubset, PREGNANT==2)))
nrow(subset(thesubset, MJEVER==1 & PREGNANT==1))/nrow(subset(thesubset, PREGNANT==1))
nrow(subset(thesubset, MJEVER==1 & PREGNANT==2))/nrow(subset(thesubset, PREGNANT==2))
irm <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, irmarit from demographics"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(irm, mj)
thesubset<-subset(merged, IRMARIT<5 & MJEVER<3)
ggplot(thesubset, aes(x=IRMARIT, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Marital status colored by marijuana use", y="Count")+scale_x_discrete("Marital status", labels = c("1" = "Married","2" = "Widowed", "3" = "Divorced or Separated", "4" = "Never been married"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, MJEVER==1 & IRMARIT==1))/nrow(subset(thesubset, IRMARIT==1)), nrow(subset(thesubset, MJEVER==1 & IRMARIT==2))/nrow(subset(thesubset, IRMARIT==2)), nrow(subset(thesubset, MJEVER==1 & IRMARIT==3))/nrow(subset(thesubset, IRMARIT==3)), nrow(subset(thesubset, MJEVER==1 & IRMARIT==4))/nrow(subset(thesubset, IRMARIT==4)))
qplot(seq_along(nums), nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))+ geom_smooth(se=FALSE, method="lm")
nrow(subset(thesubset, MJEVER==1 & IRMARIT==1))/nrow(subset(thesubset, IRMARIT==1))
nrow(subset(thesubset, MJEVER==1 & IRMARIT==3))/nrow(subset(thesubset, IRMARIT==3))
USDRGTST
usd <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, usdrgtst from demographics"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
mj <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, mjever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(usd, mj)
thesubset<-subset(merged, IRMARIT<5 & MJEVER<3)
thesubset<-subset(merged, USDRGTST<3 & MJEVER<3)
ggplot(thesubset, aes(x=USDRGTST, fill=as.factor(MJEVER)))+geom_bar()+labs(title="Marital status colored by marijuana use", y="Count")+scale_x_discrete("Marital status", labels = c("1" = "Married","2" = "Widowed", "3" = "Divorced or Separated", "4" = "Never been married"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
alcsed <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, aldaypwk, svdaypwk from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(merged, SVDAYPWK<8 & ALDAYPWK<8)
ggplot(thesubset, aes(x=ALDAYPWK, fill=as.factor(SVDAYPWK)))+geom_bar()+labs(title="Marital status colored by marijuana use", y="Count")+scale_x_discrete("Marital status", labels = c("1" = "Married","2" = "Widowed", "3" = "Divorced or Separated", "4" = "Never been married"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
thesubset<-subset(alcsed, SVDAYPWK<8 & ALDAYPWK<8)
ggplot(thesubset, aes(x=ALDAYPWK, fill=as.factor(SVDAYPWK)))+geom_bar()+labs(title="Marital status colored by marijuana use", y="Count")+scale_x_discrete("Marital status", labels = c("1" = "Married","2" = "Widowed", "3" = "Divorced or Separated", "4" = "Never been married"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALDAYPWK, y=SVDAYPWK))+geom_point(shape=19, alpha=.5, size=2, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALDAYPWK, y=SVDAYPWK))+geom_point(shape=19, alpha=.5, size=5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))+ geom_vline(xintercept = 21) + geom_hline(yintercept=18)
ggplot(thesubset, aes(x=ALDAYPWK, y=SVDAYPWK))+geom_point(shape=19, alpha=.5, size=5, position=position_jitter(width=1.5,height=.75))+labs(title="Age of first alcohol use vs age of first cigarette use", y="Age of first cigarette use")+scale_x_discrete("Age of first alcohol use", breaks=c("10", "20", "30", "40", "50", "60", "70"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=ALDAYPWK, y=SVDAYPWK))+geom_point(size=5)+labs(title="# days a week respondent uses sedatives vs alcohol")+scale_x_discrete("# of days alcohol is used", breaks=c("1", "2", "3", "4", "5", "6", "7"))
summary(thesubset)
alcsed <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, alcrec, sedrec from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(alcsed, SEDREC<4 & ALCREC<4)
ggplot(thesubset, aes(x=SEDREC, y=ALCREC))+geom_point(size=5)+labs(title="How recently respondent uses sedatives vs alcohol")+scale_x_discrete("# of days alcohol is used", breaks=c("1", "2", "3", "4", "5", "6", "7"))
ggplot(thesubset, aes(x=SEDREC, y=ALCREC))+geom_point(size=5, alpha=1/4)+labs(title="How recently respondent uses sedatives vs alcohol")+scale_x_discrete("# of days alcohol is used", breaks=c("1", "2", "3", "4", "5", "6", "7"))
ggplot(thesubset, aes(x=SEDREC, y=ALCREC))+geom_point(size=5, alpha=1/16)+labs(title="How recently respondent uses sedatives vs alcohol")+scale_x_discrete("# of days alcohol is used", breaks=c("1", "2", "3", "4", "5", "6", "7"))
ggplot(thesubset, aes(x=SEDREC, y=ALCREC))+geom_point(size=5, alpha=1/80)+labs(title="How recently respondent uses sedatives vs alcohol")+scale_x_discrete("# of days alcohol is used", breaks=c("1", "2", "3", "4", "5", "6", "7"))
ggplot(thesubset, aes(x=SEDREC, y=ALCREC))+geom_point(size=5, alpha=1/200)+labs(title="How recently respondent uses sedatives vs alcohol")+scale_x_discrete("# of days alcohol is used", breaks=c("1", "2", "3", "4", "5", "6", "7"))
irm <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, irmarit from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
irm <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, irmarit from demographics"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
her <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, herever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
merged<-merge(irm, her)
ggplot(thesubset, aes(x=IRMARIT, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
thesubset<-subset(merged, IRMARIT<5 & HEREVER<3)
ggplot(thesubset, aes(x=IRMARIT, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, HEREVER==1 & IRMARIT==1))/nrow(subset(thesubset, IRMARIT==1)), nrow(subset(thesubset, HEREVER==1 & IRMARIT==2))/nrow(subset(thesubset, IRMARIT==2)), nrow(subset(thesubset, HEREVER==1 & IRMARIT==3))/nrow(subset(thesubset, IRMARIT==3)), nrow(subset(thesubset, HEREVER==1 & IRMARIT==4))/nrow(subset(thesubset, IRMARIT==4)))
qplot(seq_along(nums), nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))+ geom_smooth(se=FALSE, method="lm")
nrow(subset(thesubset, HEREVER==1 & IRMARIT==1))/nrow(subset(thesubset, IRMARIT==1))
nrow(subset(thesubset, HEREVER==1 & IRMARIT==3))/nrow(subset(thesubset, IRMARIT==3))
qplot(seq_along(c(1, 10)), c(1,10), size=I(5), ,main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))+ geom_smooth(se=FALSE, method="lm")
barplot(c(1, 10))
barplot(c(1, 10), main="How funny it is to think of "BAD DATA" as disciplining your pet named Data") + scale_x_continuous(labels=c("None, Extra"))
barplot(c(1, 10), main="How funny it is to think of BAD DATA as disciplining your pet named Data") + scale_x_continuous(labels=c("None, Extra"))
barplot(c(1, 10), main="How funny it is to think of BAD DATA as disciplining your pet named Data") + scale_x_continuous(labels=c("None", "Extra"))
barplot(c(1, 10), main="How funny it is to think of BAD DATA as disciplining your pet named Data", names.arg=c("None", "Extra"))
ggplot(thesubset, aes(x=IRMARIT, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
oxy <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, oxycrec, herever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(merged, OXYCREC<4 & HEREVER<3)
thesubset<-subset(oxy, OXYCREC<4 & HEREVER<3)
ggplot(thesubset, aes(x=IRMARIT, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
thesubset<-subset(oxy, OXYCREC==1 | OXYCREC==2 | OXYCREC==3 | OXYCREC==91 & HEREVER<3)
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
thesubset <- thesubset[,c(1, 2, 3, 91)]
thesubset <- thesubset[,c("1", "2", "3", "91")]
head(thesubset)
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
library("DBI", lib.loc="~/R/win-library/3.0")
library("devtools", lib.loc="~/R/win-library/3.0")
library("ggplot2", lib.loc="~/R/win-library/3.0")
library("gtools", lib.loc="~/R/win-library/3.0")
library("knitr", lib.loc="~/R/win-library/3.0")
library("markdown", lib.loc="~/R/win-library/3.0")
library("plyr", lib.loc="~/R/win-library/3.0")
library("RCurl", lib.loc="~/R/win-library/3.0")
library("rJava", lib.loc="~/R/win-library/3.0")
library("RJDBC", lib.loc="~/R/win-library/3.0")
library("rmarkdown", lib.loc="~/R/win-library/3.0")
library("sqldf", lib.loc="~/R/win-library/3.0")
library("stats", lib.loc="C:/Program Files/R/R-3.0.3/library")
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, HEREVER==1 & OXYCREC==1))/nrow(subset(thesubset, OXYCREC==1)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==2))/nrow(subset(thesubset, OXYCREC==2)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==3))/nrow(subset(thesubset, OXYCREC==3)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==91))/nrow(subset(thesubset, OXYCREC==91)))
qplot(seq_along(nums), nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))+ geom_smooth(se=FALSE, method="lm")
oxy <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, iroxyrc, herever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
ggplot(thesubset, aes(x=IROXYRC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=IROXYRC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
oxy <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, oxycrec, herever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(oxy, OXYCREC<4 & HEREVER<3)
head(thesubset)
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
thesubset<-subset(oxy, HEREVER<3)
thesubset$OXYCREC<-replace(thesubset$OXYREC, thesubset$OXYREC==91, 4)
oxy <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, oxycrec, herever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(oxy, HEREVER<3)
replace(thesubset, OXYREC==91, 4)
replace(thesubset, OXYCREC==91, 4)
str(thesubset)
replace(thesubset, OXYCREC=="91", "4")
replace(thesubset$OXYCREC, thesubset$OXYCREC=="91", "4")
oxy <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, oxycrec, herever from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
thesubset<-subset(oxy, HEREVER<3)
thesubset<-replace(thesubset$OXYCREC, thesubset$OXYCREC=="91", "4")
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
thesubset<-replace(thesubset$OXYCREC, thesubset$OXYCREC=="91", 4)
thesubset<-replace(thesubset$OXYCREC, thesubset$OXYCREC==91, 4)
thesubset<-replace(thesubset$OXYCREC, thesubset$OXYCREC=="91", "4")
thesubset<-subset(oxy, HEREVER<3)
thesubset<-replace(thesubset$OXYCREC, thesubset$OXYCREC=="91", "4")
thesubset<-subset(oxy, HEREVER<3)
thesubset<-replace(thesubset$OXYCREC, thesubset$OXYCREC==91, 4)
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
str(thesubset)
thesubset<-subset(oxy, HEREVER<3)
thesubset$OXYCREC<-replace(thesubset$OXYCREC, thesubset$OXYCREC==91, 4)
str(thesubset)
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
thesubset
thesubset<-subset(oxy, OXYCREC==1|OXYREC==2|OXYCREC==3|OXYCREC==91&HEREVER<3)
thesubset<-subset(oxy, OXYCREC==1|OXYCREC==2|OXYCREC==3|OXYCREC==91&HEREVER<3)
thesubset$OXYCREC<-replace(thesubset$OXYCREC, thesubset$OXYCREC==91, 4)
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, HEREVER==1 & OXYCREC==1))/nrow(subset(thesubset, OXYCREC==1)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==2))/nrow(subset(thesubset, OXYCREC==2)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==3))/nrow(subset(thesubset, OXYCREC==3)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==91))/nrow(subset(thesubset, OXYCREC==91)))
qplot(seq_along(nums), nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
nums<-c(nrow(subset(thesubset, HEREVER==1 & OXYCREC==1))/nrow(subset(thesubset, OXYCREC==1)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==2))/nrow(subset(thesubset, OXYCREC==2)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==3))/nrow(subset(thesubset, OXYCREC==3)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==91))/nrow(subset(thesubset, OXYCREC==91)))
qplot(seq_along(nums), nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
nums<-c(nrow(subset(thesubset, HEREVER==1 & OXYCREC==1))/nrow(subset(thesubset, OXYCREC==1)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==2))/nrow(subset(thesubset, OXYCREC==2)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==3))/nrow(subset(thesubset, OXYCREC==3)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==91))/nrow(subset(thesubset, OXYCREC==91)))
qplot(seq_along(nums), nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
qplot(seq_along(nums), nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana")
nrow(subset(thesubset, HEREVER==1 & OXYCREC==91))/nrow(subset(thesubset, OXYCREC==91))
nums<-c(nrow(subset(thesubset, HEREVER==1 & OXYCREC==1))/nrow(subset(thesubset, OXYCREC==1)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==2))/nrow(subset(thesubset, OXYCREC==2)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==3))/nrow(subset(thesubset, OXYCREC==3)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==4))/nrow(subset(thesubset, OXYCREC==4)))
qplot(seq_along(nums), nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana")
qplot(nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana")
nums<-c(nrow(subset(thesubset, HEREVER==1 & OXYCREC==1))/nrow(subset(thesubset, OXYCREC==1)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==2))/nrow(subset(thesubset, OXYCREC==2)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==3))/nrow(subset(thesubset, OXYCREC==3)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==4))/nrow(subset(thesubset, OXYCREC==4)))
qplot(seq_along(nums), nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
qplot(nums, size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
qplot(nums, geom="bar", size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
qplot(nums, data=df, geom="bar", size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
plot(nums)
plot(nums, geom="bar")
hist(nums)
df=data.frame(nums)
head(df)
qplot(nums, data=df, geom="bar", size=I(5), ylim=c(0,1),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
qplot(nums, data=df, geom="bar", size=I(5),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
qplot(nums, data=df, geom="bar", size=I(5))
qplot(y=nums, data=df, geom="bar", size=I(5),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
qplot(x=nums, data=df, geom="bar", size=I(5),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
df=data.frame(A=c(1, 2, 3, 4), B=nums)
qplot(x=A, y=B data=df, geom="bar", size=I(5),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
qplot(x=A, y=B, data=df, geom="bar", size=I(5),main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
barplot(nums, main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="# of religious services attended in past year colored by marijuana use", y="Count")+scale_x_discrete("# of religious services attended in past year", labels = c("1" = "0","2" = "1", "3" = "3","4" = "6", "5" = "25", "6" = "52+"))+scale_fill_discrete(name="Ever used marijuana", breaks=c("1", "2"), labels=c("Yes", "No"))
ggplot(thesubset, aes(x=OXYCREC, fill=as.factor(HEREVER)))+geom_bar()+labs(title="Recency of oxycontin use by ever used heroin", y="Count")+scale_x_discrete("Recency of oxycontin use", labels = c("1" = "<30 days ago","2" = ">30 days but <1 year ago", "3" = ">1 year ago","4" = "Never used heroin"))+scale_fill_discrete(name="Ever used heroin", breaks=c("1", "2"), labels=c("Yes", "No"))
nums<-c(nrow(subset(thesubset, HEREVER==1 & OXYCREC==1))/nrow(subset(thesubset, OXYCREC==1)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==2))/nrow(subset(thesubset, OXYCREC==2)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==3))/nrow(subset(thesubset, OXYCREC==3)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==4))/nrow(subset(thesubset, OXYCREC==4)))
nums<-c(nrow(subset(thesubset, HEREVER==1 & OXYCREC==1))/nrow(subset(thesubset, OXYCREC==1)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==2))/nrow(subset(thesubset, OXYCREC==2)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==3))/nrow(subset(thesubset, OXYCREC==3)), nrow(subset(thesubset, HEREVER==1 & OXYCREC==4))/nrow(subset(thesubset, OXYCREC==4)))
barplot(nums, main="Proportion of each level of 65+ household members that have used marijuana", xlab="Number of people in household over 65 colored by marijuana use", ylab="Proportion of respondents who have used marijuana") + scale_x_continuous(breaks=c(1, 2, 3), labels=c("0", "1", "2+"))
barplot(nums, main="Proportion of each level of oxycontin recency that have used heroin", xlab="Recency of oxycontin use", ylab="Proportion of respondents who have used heroin") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("<30 days ago", ">30 days but <1 year ago", ">1 year ago", "Never used heroin"))
barplot(nums, ylim=1, main="Proportion of each level of oxycontin recency that have used heroin", xlab="Recency of oxycontin use", ylab="Proportion of respondents who have used heroin") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("<30 days ago", ">30 days but <1 year ago", ">1 year ago", "Never used heroin"))
barplot(nums, ylim=c(0,1), main="Proportion of each level of oxycontin recency that have used heroin", xlab="Recency of oxycontin use", ylab="Proportion of respondents who have used heroin") + scale_x_continuous(breaks=c(1, 2, 3, 4), labels=c("<30 days ago", ">30 days but <1 year ago", ">1 year ago", "Never used heroin"))
barplot(nums, ylim=c(0,1), main="Proportion of each level of oxycontin recency that have used heroin", xlab="Recency of oxycontin use", ylab="Proportion of respondents who have used heroin", names.arg=c("<30 days ago", ">30 days but <1 year ago", ">1 year ago", "Never used heroin"))
core <- data.frame(eval(parse(text=substring(getURL(URLencode('http://129.152.144.84:5001/rest/native/?query="select rid, cigrec, psilcy from core_substance"'), httpheader=c(DB='jdbc:oracle:thin:@129.152.144.84:1521/PDB1.usuniversi01134.oraclecloud.internal', USER='cs370_jls6673', PASS='orcl', MODE='native_mode', MODEL='model', returnFor = 'R', returnDimensions = 'False'), verbose = TRUE), 1, 2^31-1))))
